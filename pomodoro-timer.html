<!--
Copyright (c) 2025 Daily Growth
https://yourworklifedesign.blogspot.com/
All rights reserved.
-->
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlowState</title>
    <style>
        :root {
            --primary-color: #ff6347;
            --secondary-color: #4caf50;
            --background-color: #ffffff;
            --text-color: #333333;
            --card-background: #f5f5f5;
            --border-color: #dddddd;
            --completed-color: #888888;
            --progress-bg: #eeeeee;
        }

        [data-theme="dark"] {
            --primary-color: #ff7f6e;
            --secondary-color: #5cca60;
            --background-color: #1f1f1f;
            --text-color: #f0f0f0;
            --card-background: #2d2d2d;
            --border-color: #444444;
            --completed-color: #aaaaaa;
            --progress-bg: #333333;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 1800px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr;
            grid-gap: 20px;
            height: calc(100vh - 40px);
        }

        @media (min-width: 768px) {
            .container {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (min-width: 1600px) {
            .container {
                grid-template-columns: 1fr 1fr 1fr;
            }
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            grid-column: 1 / -1;
        }

        .title {
            font-size: clamp(24px, 3vw, 48px);
            font-weight: bold;
            color: var(--primary-color);
        }

        .theme-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .timer-section {
            background-color: var(--card-background);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px;
        }

        .circle-progress {
            position: relative;
            width: clamp(200px, 30vw, 400px);
            height: clamp(200px, 30vw, 400px);
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .circle-progress svg {
            position: absolute;
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .circle-background {
            fill: none;
            stroke: var(--progress-bg);
            stroke-width: 15;
        }

        .circle-progress-bar {
            fill: none;
            stroke: var(--primary-color);
            stroke-width: 15;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s;
        }

        .time-display {
            position: absolute;
            font-size: clamp(36px, 5vw, 72px);
            font-weight: bold;
            color: var(--primary-color);
        }

        .status {
            font-size: clamp(18px, 2vw, 24px);
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--primary-color);
            text-shadow: 0 0 10px rgba(255, 99, 71, 0.5);
            animation: glow 1.5s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from {
                text-shadow: 0 0 5px rgba(255, 99, 71, 0.5);
            }
            to {
                text-shadow: 0 0 15px rgba(255, 99, 71, 0.8), 0 0 20px rgba(255, 99, 71, 0.5);
            }
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        .btn {
            padding: 12px 24px;
            font-size: clamp(14px, 1.5vw, 18px);
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            min-width: 100px;
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--border-color);
            color: var(--text-color);
        }

        .counter {
            font-size: clamp(14px, 1.5vw, 18px);
            margin-top: 20px;
        }

        .settings {
            background-color: var(--card-background);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }

        .settings h2 {
            font-size: clamp(18px, 2vw, 24px);
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(100, 100, 255, 0.5);
            animation: settings-glow 1.5s ease-in-out infinite alternate;
        }
        
        @keyframes settings-glow {
            from {
                text-shadow: 0 0 5px rgba(100, 100, 255, 0.5);
            }
            to {
                text-shadow: 0 0 15px rgba(100, 100, 255, 0.8), 0 0 20px rgba(100, 100, 255, 0.5);
            }
        }

        .setting-group {
            margin-bottom: 15px;
        }

        .setting-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .setting-group input[type="range"] {
            width: 100%;
            margin-bottom: 10px;
        }

        .time-display-small {
            font-size: clamp(14px, 1.5vw, 18px);
            font-weight: bold;
        }

        .preset-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .preset-btn {
            padding: 8px 16px;
            font-size: 14px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: transparent;
            color: var(--text-color);
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
        }

        .preset-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }

        .tasks-section {
            background-color: var(--card-background);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            flex: 1;
            overflow: hidden;
        }

        .tasks-section h2 {
            font-size: clamp(18px, 2vw, 24px);
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
            animation: task-glow 1.5s ease-in-out infinite alternate;
        }
        
        @keyframes task-glow {
            from {
                text-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
            }
            to {
                text-shadow: 0 0 15px rgba(76, 175, 80, 0.8), 0 0 20px rgba(76, 175, 80, 0.5);
            }
        }

        .task-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .task-input {
            flex: 1;
            padding: 12px;
            font-size: 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--background-color);
            color: var(--text-color);
        }

        .pomodoro-count {
            width: 60px;
            padding: 12px;
            font-size: 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--background-color);
            color: var(--text-color);
            text-align: center;
        }

        .task-list {
            list-style-type: none;
            overflow-y: auto;
            flex: 1;
        }

        .task-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            margin-bottom: 10px;
            background-color: var(--background-color);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            cursor: move;
            transition: transform 0.2s, box-shadow 0.2s;
            border-left: 4px solid transparent;
        }

        .task-item:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .task-item.dragging {
            opacity: 0.5;
            transform: scale(1.02);
        }
        
        .task-item.active {
            border-left: 4px solid var(--primary-color);
            background-color: rgba(255, 99, 71, 0.1);
            box-shadow: 0 0 12px rgba(255, 99, 71, 0.2);
        }

        .task-checkbox {
            margin-right: 15px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .task-text {
            flex: 1;
            font-size: 16px;
            transition: color 0.2s, text-decoration 0.2s;
        }

        .task-completed .task-text {
            color: var(--completed-color);
            text-decoration: line-through;
        }

        .task-drag-handle {
            cursor: grab;
            padding: 5px;
            margin-right: 10px;
            color: var(--border-color);
        }

        .task-pomodoro-counter {
            display: flex;
            align-items: center;
            margin-right: 15px;
            font-size: 14px;
        }

        .task-delete {
            background: none;
            border: none;
            color: #ff0000;
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.2s;
            font-size: 18px;
        }

        .task-delete:hover {
            opacity: 1;
        }

        .task-stats {
            margin-top: 20px;
            font-size: 14px;
            color: var(--text-color);
            opacity: 0.8;
        }

        .hide-completed {
            margin-top: 10px;
            background: none;
            border: 1px solid var(--border-color);
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            color: var(--text-color);
        }

        .focus-mode-toggle {
            margin-top: 15px;
            display: flex;
            align-items: center;
            font-size: 14px;
        }

        .focus-mode-toggle input {
            margin-right: 8px;
        }

        .statistics-section {
            background-color: var(--card-background);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .statistics-section h2 {
            font-size: clamp(18px, 2vw, 24px);
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
            animation: stats-glow 1.5s ease-in-out infinite alternate;
        }
        
        @keyframes stats-glow {
            from {
                text-shadow: 0 0 5px rgba(255, 193, 7, 0.5);
            }
            to {
                text-shadow: 0 0 15px rgba(255, 193, 7, 0.8), 0 0 20px rgba(255, 193, 7, 0.5);
            }
        }

        .stats-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .stat-card {
            background-color: var(--background-color);
            border-radius: 8px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.8;
        }

        .chart-container {
            width: 100%;
            height: 200px;
            margin-top: 20px;
        }

        @media (max-width: 767px) {
            .container {
                height: auto;
            }
            
            .timer-section,
            .tasks-section,
            .statistics-section {
                min-height: auto;
            }
            
            .task-list {
                max-height: 300px;
            }
        }

        /* Focus Mode */
        body.focus-mode .tasks-section,
        body.focus-mode .statistics-section {
            display: none;
        }

        body.focus-mode .container {
            grid-template-columns: 1fr;
        }

        body.focus-mode .timer-section {
            height: calc(100vh - 120px);
        }
		.chart-toggle {
		  display: flex;
		  justify-content: center;
		  margin-bottom: 10px;
		}

		.chart-toggle-btn {
		  padding: 5px 10px;
		  margin: 0 5px;
		  border: 1px solid var(--border-color);
		  border-radius: 4px;
		  background-color: transparent;
		  color: var(--text-color);
		  cursor: pointer;
		  transition: background-color 0.2s;
		}

		.chart-toggle-btn.active {
		  background-color: var(--primary-color);
		  color: white;
		}
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="title">FlowState</h1>
            <label class="theme-switch">
                <input type="checkbox" id="theme-toggle">
                <span class="slider"></span>
            </label>
        </header>

        <section class="timer-section">
            <div class="circle-progress">
                <svg>
                    <circle class="circle-background" cx="50%" cy="50%" r="45%" />
                    <circle class="circle-progress-bar" cx="50%" cy="50%" r="45%" />
                </svg>
                <div class="time-display">25:00</div>
            </div>
            <div class="status">‰ΩúÊ•≠</div>
            <div class="controls">
                <button class="btn btn-primary" id="start-btn">‚ñ∂Ô∏è„Çπ„Çø„Éº„Éà</button>
                <button class="btn btn-secondary" id="pause-btn" disabled>‚è∏Ô∏è„Éù„Éº„Ç∫</button>
                <button class="btn btn-outline" id="reset-btn">üîÅ „É™„Çª„ÉÉ„Éà</button>
            </div>
            <div class="counter">ÂÆå‰∫Ü„Åó„ÅüÁ¥ØÁ©ç„Éù„É¢„Éâ„Éº„É≠: <span id="pomodoro-count">0</span></div>

            <div class="settings">
                <h2 class="settings-title">‚öôÔ∏è Ë®≠ÂÆö</h2>
                <div class="setting-group">
                    <label for="work-time">üî•‰ΩúÊ•≠ÊôÇÈñì: <span id="work-time-display">25</span>ÂàÜ</label>
                    <input type="range" id="work-time" min="1" max="60" value="25">
                </div>
                <div class="setting-group">
                    <label for="break-time">‚òï‰ºëÊÜ©ÊôÇÈñì: <span id="break-time-display">5</span>ÂàÜ</label>
                    <input type="range" id="break-time" min="1" max="30" value="5">
                </div>
                <div class="preset-buttons">
                    <button class="preset-btn" data-work="15" data-break="5">15/5</button>
                    <button class="preset-btn" data-work="25" data-break="5">25/5</button>
                    <button class="preset-btn" data-work="40" data-break="10">40/10</button>
                    <button class="preset-btn" data-work="50" data-break="10">50/10</button>
                </div>
                <div class="focus-mode-toggle">
                    <input type="checkbox" id="focus-mode"> <label for="focus-mode">ÈõÜ‰∏≠„É¢„Éº„Éâ</label>
                </div>
            </div>
        </section>

        <section class="tasks-section">
            <h2>üìù „Çø„Çπ„ÇØ„É™„Çπ„Éà</h2>
            <form id="task-form" class="task-form">
                <input type="text" id="task-input" class="task-input" placeholder="Êñ∞„Åó„ÅÑ„Çø„Çπ„ÇØ„ÇíÂÖ•Âäõ..." required>
                <input type="number" id="pomodoro-count-input" class="pomodoro-count" min="1" value="1"
                    title="‰∫àÂÆö„Éù„É¢„Éâ„Éº„É≠Êï∞">
                <button type="submit" class="btn btn-primary">‚ûï ËøΩÂä†</button>
            </form>
            <ul id="task-list" class="task-list"></ul>
            <div class="task-stats">
                <p>ÂÖ®„Çø„Çπ„ÇØ: <span id="total-tasks">0</span> / ÂÆå‰∫Ü: <span id="completed-tasks">0</span></p>
                <button class="hide-completed" id="toggle-completed">üëÅÔ∏è ÂÆå‰∫Ü„Åó„Åü„Çø„Çπ„ÇØ„ÇíË°®Á§∫/ÈùûË°®Á§∫</button>
            </div>
        </section>

        <section class="statistics-section">
            <h2 class="statistics-title">üìä Áµ±Ë®à</h2>
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-value" id="today-pomodoros">0</div>
                    <div class="stat-label">Êú¨Êó•„ÅÆ„Éù„É¢„Éâ„Éº„É≠</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-time">0</div>
                    <div class="stat-label">Êú¨Êó•„ÅÆÈõÜ‰∏≠ÊôÇÈñì (ÂàÜ)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="completed-tasks-count">0</div>
                    <div class="stat-label">ÂÆå‰∫Ü„Åó„Åü„Çø„Çπ„ÇØ</div>
                </div>
            </div>
            <div class="chart-container">
				<div class="chart-toggle">
				  <button id="show-pomodoros" class="chart-toggle-btn active">üçÖ „Éù„É¢„Éâ„Éº„É≠Êï∞</button>
				  <button id="show-focus-time" class="chart-toggle-btn">‚è±Ô∏è ÈõÜ‰∏≠ÊôÇÈñì</button>
				</div>
                <!-- „Åì„Åì„Å´ÈÄ±Èñì„Ç∞„É©„Éï„ÅåË°®Á§∫„Åï„Çå„Çã -->
                <svg id="weekly-chart" width="100%" height="100%"></svg>
            </div>
        </section>
    </div>

    <audio id="notification-sound" src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBhxQo/T/xHQrChs2e9f6zHg9CgoPHF7O/+GaTgcDAwtHuvj/qlMBAAMGM6Xo/8JmCAAAAyBsx+3/pGkhAQUKDi5p4Pv/owEACA8cJjWQ7///VwIBDRs2WvL//5FaKBMlLDxP4f//mzUEChYwM0ro//+uXiMSFiUb/fT8yxcY4bbc//oJ/iRXweDl+A0VCycrVrXq/v8RBQkbKkWm4/7/EgMBAwkNVI/q//8vDwEAAgQ3qff//1ASAQABBSOBzvn/cFILAgEDD2vT//94Mg0FBAkQf+r//11DBQMFCxmJ7f/qvksyWs7//wsWIzFTu/P//x4LEApXpuD6/yYGEA8gSfr//4ogDAYHDh1FzvH//1sLBAQHDW3z//9oHQoEBAcea9X//2YhCwUFCRqO6v//ZhsIAwQILvL//3EcBAEBBET//5kyBgIAAgZL6P//3mphco+gemo0FICjromPfWthYHOJnp9MBj1qusjBiWA9THTY//+SOQEVVbLc5fJJIRUySbPc6PgtEBQjL2C/4O76Jw0PIzFVmdnw/DIQDxgfL7Hf//k+EAwUISEvsOL//ogZBQACA1OL1Pv/chgGAAADQLPu//9mGgYAAAY0ltv//2oZBQABBy3Q/P//cRIFAAIZhdT//3YaBwEABC/j//+EGQIBAgxb1f//aRgDAwMOitL//2AXBAUGGvL//2AcBgICCkno//9wGgQCAgdR4f//bxcDAQMRrN3//0sZCQQEB1TN//9CGgkEBART4f//TBsGAwURgdz//0kaCAgJFX/j//9LIxYQEhGC5v//VDIhGRoVe+X//1pGMCoqHpnw//9DMjY0Jj7a//9iY1JJSzq9//++d0tGRD2L+f//kHcAAAABAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAABgAAAAMAAAAAAAAAAAAABwAAAAQAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAQAAAAIAAAACAAAAAgAAAAIAAAADAAAAAwAAAAMAAAADAAAABAAAAAQAAAAEAAAABAAAYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXp7fH1+f4CBgoOEhYaHiImKi4yNjo+QkZKTlJWWl5iZmpucnZ6foKGio6SlpqeoqaqrrK2ur7CxsrO0tba3uLm6u7y9vr/AwcLDxMXGx8jJysvMzc7P0NHS09TV1tfY2drb3N3e3+Dh4uPk5ebn6Onq6+zt7u/w8fLz9PX29/j5+vv8/f7/AAECAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGxwdHh8gISIjJCUmJygpKissLS4vMDEyMzQ1Njc4OTo7PD0+P0BBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWltcXV5fYGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6e3x9fn+AgYKDhIWGh4iJiouMjY6PkJGSk5SVlpeYmZqbnJ2en6ChoqOkpaanqKmqq6ytrq+wsbKztLW2t7i5uru8vb6/wMHCw8TFxsfIycrLzM3Oz9DR0tPU1dbX2Nna29zd3t/g4eLj5OXm5+jp6uvs7e7v8PHy8/T19vf4+fr7/P3+/w==">

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const startBtn = document.getElementById('start-btn');
            const pauseBtn = document.getElementById('pause-btn');
            const resetBtn = document.getElementById('reset-btn');
            const timeDisplay = document.querySelector('.time-display');
            const statusDisplay = document.querySelector('.status');
            const pomodoroCountDisplay = document.getElementById('pomodoro-count');
            const circleProgress = document.querySelector('.circle-progress-bar');
            const workTimeSlider = document.getElementById('work-time');
            const breakTimeSlider = document.getElementById('break-time');
            const workTimeDisplay = document.getElementById('work-time-display');
            const breakTimeDisplay = document.getElementById('break-time-display');
            const themeToggle = document.getElementById('theme-toggle');
            const presetButtons = document.querySelectorAll('.preset-btn');
            const taskForm = document.getElementById('task-form');
            const taskInput = document.getElementById('task-input');
            const pomodoroCountInput = document.getElementById('pomodoro-count-input');
            const taskList = document.getElementById('task-list');
            const totalTasksDisplay = document.getElementById('total-tasks');
            const completedTasksDisplay = document.getElementById('completed-tasks');
            const toggleCompletedBtn = document.getElementById('toggle-completed');
            const focusModeToggle = document.getElementById('focus-mode');
            const notificationSound = document.getElementById('notification-sound');
            const todayPomodorosDisplay = document.getElementById('today-pomodoros');
            const totalTimeDisplay = document.getElementById('total-time');
            const completedTasksCountDisplay = document.getElementById('completed-tasks-count');
            const weeklyChart = document.getElementById('weekly-chart');
			const showPomodorosBtn = document.getElementById('show-pomodoros');
			const showFocusTimeBtn = document.getElementById('show-focus-time');
			let chartDisplayMode = 'pomodoros'; // „Éá„Éï„Ç©„É´„ÉàË°®Á§∫„É¢„Éº„Éâ

            // Timer State
            let timer = {
                workTime: 25 * 60, // 25ÂàÜÔºàÁßíÂçò‰ΩçÔºâ
                breakTime: 5 * 60,  // 5ÂàÜÔºàÁßíÂçò‰ΩçÔºâ
                currentTime: 25 * 60,
                isRunning: false,
                interval: null,
                mode: 'work', // 'work' or 'break'
                pomodoroCount: 0
            };

			// 1. stats„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆÊßãÈÄ†Â§âÊõ¥
			let stats = {
			    completedTasks: 0,
			    // weeklyData„ÅÆÊßãÈÄ†„ÇíÂ§âÊõ¥
			    weeklyData: [] // ÈÅéÂéª„ÅÆ„Éá„Éº„Çø„Çí {date: "YYYY-MM-DD", pomodoros: 0, focusTime: 0} ÂΩ¢Âºè„Åß‰øùÂ≠ò
			};

            // Tasks
            let tasks = [];
            let hideCompleted = false;
            
            // „Ç∞„É≠„Éº„Éê„É´„Çπ„Ç≥„Éº„Éó„Åß„Ç§„É≥„Çø„Éº„Éê„É´ID„Çí‰øùÊåÅ„Åô„ÇãÂ§âÊï∞
			let dateCheckIntervalId = null;

			// 2. Êó•‰ªò„ÉÅ„Çß„ÉÉ„ÇØÈñ¢Êï∞„ÅÆ‰øÆÊ≠£
			function checkDateChange() {
			    const today = new Date().toDateString();
			    const todayFormatted = formatDateYMD(new Date()); // YYYY-MM-DDÂΩ¢Âºè„ÅÆÊó•‰ªò
			    const lastDate = localStorage.getItem('pomodoroLastDate');
			    console.log("checkDateChange lastDate:",lastDate);
			    console.log("checkDateChange today:",today);
			    if (lastDate !== today) {
			        // ÂâçÂõû„ÅÆÊó•‰ªò„Åå„ÅÇ„ÇãÂ†¥Âêà„ÄÅÊñ∞„Åó„ÅÑ„Ç®„É≥„Éà„É™„ÇíËøΩÂä†
			        const todayEntry = stats.weeklyData.find(entry => entry.date === todayFormatted);
			        
			        if (!todayEntry) {
			            // ‰ªäÊó•„ÅÆ„Ç®„É≥„Éà„É™„Åå„Åæ„Å†„Å™„Åë„Çå„Å∞„ÄÅÊñ∞„Åó„ÅÑ„Ç®„É≥„Éà„É™„ÇíËøΩÂä†
			            stats.weeklyData.unshift({
			                date: todayFormatted,
			                pomodoros: 0,
			                focusTime: 0
			            });
			            
			            // 7Êó•ÂàÜ‰ª•‰∏ä„ÅÇ„Çå„Å∞Âè§„ÅÑ„ÇÇ„ÅÆ„ÇíÂâäÈô§
			            while (stats.weeklyData.length > 7) {
			                stats.weeklyData.pop();
			            }
			        }
			        
			        // ÊúÄÁµÇÊó•‰ªò„ÇíÊõ¥Êñ∞
			        localStorage.setItem('pomodoroLastDate', today);
			        
			        // Áµ±Ë®àË°®Á§∫„ÇíÊõ¥Êñ∞
			        updateStatisticsDisplay();
			        drawWeeklyChart();
    			    console.log("checkDateChange ‚óã„ÄÄupdate!:");
			    }else{
    			    console.log("checkDateChange √óno update:");
			    }
			}

			// 3. Êó•‰ªò„ÇíYYYY-MM-DDÂΩ¢Âºè„Å´„Éï„Ç©„Éº„Éû„ÉÉ„Éà„Åô„ÇãÈñ¢Êï∞„ÅÆËøΩÂä†
			function formatDateYMD(date) {
			    const year = date.getFullYear();
			    const month = String(date.getMonth() + 1).padStart(2, '0');
			    const day = String(date.getDate()).padStart(2, '0');
			    return `${year}-${month}-${day}`;
			}
			
            // „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Åã„Çâ„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„ÇÄ
            function loadFromLocalStorage() {
                // „Çø„Ç§„Éû„ÉºË®≠ÂÆö
                const savedSettings = JSON.parse(localStorage.getItem('pomodoroSettings'));
                if (savedSettings) {
                    timer.workTime = savedSettings.workTime;
                    timer.breakTime = savedSettings.breakTime;
                    workTimeSlider.value = timer.workTime / 60;
                    breakTimeSlider.value = timer.breakTime / 60;
                    workTimeDisplay.textContent = timer.workTime / 60;
                    breakTimeDisplay.textContent = timer.breakTime / 60;
                }

                // „Çø„Çπ„ÇØ
                const savedTasks = JSON.parse(localStorage.getItem('pomodoroTasks'));
                if (savedTasks) {
                    tasks = savedTasks;
                    renderTasks();
                }

			    // Áµ±Ë®à
			    const savedStats = JSON.parse(localStorage.getItem('pomodoroStats'));
			    if (savedStats) {
			        stats = savedStats;
			    } else {
			        // ÂàùÊúü„Éá„Éº„Çø„Åå„Å™„ÅÑÂ†¥Âêà„ÅØ‰ΩúÊàê
			        const today = formatDateYMD(new Date());
			        stats = {
			            completedTasks: 0,
			            weeklyData: [{
			                date: today,
			                pomodoros: 0,
			                focusTime: 0
			            }]
			        };
			        localStorage.setItem('pomodoroLastDate', new Date().toDateString());
			    }
                // „ÉÜ„Éº„Éû
                const darkMode = localStorage.getItem('pomodoroDarkMode') === 'true';
                themeToggle.checked = darkMode;
                if (darkMode) {
                    document.documentElement.setAttribute('data-theme', 'dark');
                }

                // „Éù„É¢„Éâ„Éº„É≠„Ç´„Ç¶„É≥„Éà
                timer.pomodoroCount = parseInt(localStorage.getItem('pomodoroCount') || '0');
                pomodoroCountDisplay.textContent = timer.pomodoroCount;

            }

            // „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Å´„Éá„Éº„Çø„Çí‰øùÂ≠ò
            function saveToLocalStorage() {
                // „Çø„Ç§„Éû„ÉºË®≠ÂÆö
                localStorage.setItem('pomodoroSettings', JSON.stringify({
                    workTime: timer.workTime,
                    breakTime: timer.breakTime
                }));

                // „Çø„Çπ„ÇØ
                localStorage.setItem('pomodoroTasks', JSON.stringify(tasks));

                // Áµ±Ë®à
                localStorage.setItem('pomodoroStats', JSON.stringify(stats));
                //localStorage.setItem('pomodoroLastDate', new Date().toDateString());

                // „ÉÜ„Éº„Éû
                localStorage.setItem('pomodoroDarkMode', themeToggle.checked);

                // „Éù„É¢„Éâ„Éº„É≠„Ç´„Ç¶„É≥„Éà
                localStorage.setItem('pomodoroCount', timer.pomodoroCount);
            }

            // Êó•‰ªò„Éï„Ç©„Éº„Éû„ÉÉ„ÉàÈñ¢Êï∞
            function formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }

            // „Çø„Ç§„Éû„ÉºÊõ¥Êñ∞Èñ¢Êï∞
            function updateTimer() {
                if (timer.currentTime > 0) {
                    timer.currentTime--;
                    timeDisplay.textContent = formatTime(timer.currentTime);
                    
                    // „Éó„É≠„Ç∞„É¨„Çπ„Éê„ÉºÊõ¥Êñ∞
                    const totalTime = timer.mode === 'work' ? timer.workTime : timer.breakTime;
                    const circumference = 2 * Math.PI * parseFloat(circleProgress.getAttribute('r'));
                    const offset = circumference - (timer.currentTime / totalTime) * circumference;
                    circleProgress.style.strokeDasharray = `${circumference} ${circumference}`;
                    circleProgress.style.strokeDashoffset = offset;
                } else {
                    // „Çø„Ç§„Éû„ÉºÁµÇ‰∫Ü
                    clearInterval(timer.interval);
                    timer.isRunning = false;
                    //notificationSound.play();
                    // ÈÄöÁü•„ÇíË°®Á§∫
                    notifyTimerEnd();
					// „Çø„Ç§„Éû„ÉºÊõ¥Êñ∞Èñ¢Êï∞ÂÜÖ„ÅÆ„Éù„É¢„Éâ„Éº„É≠ÂÆå‰∫ÜÊôÇ„ÅÆÂá¶ÁêÜ„ÇíÂ§âÊõ¥
					// updateTimerÈñ¢Êï∞ÂÜÖ„ÅÆË©≤ÂΩìÈÉ®ÂàÜ„ÇíÂ§âÊõ¥
					if (timer.mode === 'work') {
					    // ‰ΩúÊ•≠„É¢„Éº„Éâ„ÅåÁµÇ‰∫Ü„Åó„ÅüÂ†¥Âêà
					    timer.mode = 'break';
					    timer.currentTime = timer.breakTime;
					    statusDisplay.textContent = '‰ºëÊÜ©';
					    statusDisplay.style.color = 'var(--secondary-color)';
					    circleProgress.style.stroke = 'var(--secondary-color)';
					    timer.pomodoroCount++;
					    pomodoroCountDisplay.textContent = timer.pomodoroCount;
					    
					    // Áµ±Ë®àÊõ¥Êñ∞
					    const today = formatDateYMD(new Date());
					    // ‰ªäÊó•„ÅÆ„Éá„Éº„Çø„Åå„ÅÇ„Çã„ÅãÁ¢∫Ë™ç
					    let todayEntry = stats.weeklyData.find(entry => entry.date === today);
					    
					    if (!todayEntry) {
					        // ‰ªäÊó•„ÅÆ„Ç®„É≥„Éà„É™„Åå„Å™„Åë„Çå„Å∞ËøΩÂä†
					        todayEntry = {
					            date: today,
					            pomodoros: 0,
					            focusTime: 0
					        };
					        stats.weeklyData.unshift(todayEntry);
					        
					        // 7Êó•ÂàÜ‰ª•‰∏ä„ÅÇ„Çå„Å∞Âè§„ÅÑ„ÇÇ„ÅÆ„ÇíÂâäÈô§
					        while (stats.weeklyData.length > 7) {
					            stats.weeklyData.pop();
					        }
					    }
					    
					    // ‰ªäÊó•„ÅÆ„Éá„Éº„Çø„ÇíÊõ¥Êñ∞
					    todayEntry.pomodoros++;
					    todayEntry.focusTime += timer.workTime / 60;
					    
					    updateStatisticsDisplay();
					    drawWeeklyChart();
					    
					    // ÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Çã„Çø„Çπ„ÇØ„ÅÆ„Éù„É¢„Éâ„Éº„É≠„Ç´„Ç¶„É≥„Éà„ÇíÊõ¥Êñ∞
					    updateTaskPomodoro();
					} else {
                        // ‰ºëÊÜ©„É¢„Éº„Éâ„ÅåÁµÇ‰∫Ü„Åó„ÅüÂ†¥Âêà
                        timer.mode = 'work';
                        timer.currentTime = timer.workTime;
                        statusDisplay.textContent = '‰ΩúÊ•≠';
                        statusDisplay.style.color = 'var(--primary-color)';
                        circleProgress.style.stroke = 'var(--primary-color)';
                    }
                    
                    timeDisplay.textContent = formatTime(timer.currentTime);
                    startBtn.disabled = false;
                    pauseBtn.disabled = true;
                    
                    saveToLocalStorage();
                }
            }

            // ÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Çã„Çø„Çπ„ÇØ„ÅÆ„Éù„É¢„Éâ„Éº„É≠„Ç´„Ç¶„É≥„Éà„ÇíÊõ¥Êñ∞
            function updateTaskPomodoro() {
                const activeTaskItem = document.querySelector('.task-item.active');
                if (activeTaskItem) {
                    const taskId = activeTaskItem.dataset.id;
                    const taskIndex = tasks.findIndex(task => task.id === taskId);
                    
                    if (taskIndex !== -1) {
                        tasks[taskIndex].completedPomodoros = (tasks[taskIndex].completedPomodoros || 0) + 1;
                        renderTasks();
                        saveToLocalStorage();
                    }
                }
            }

			// „Ç¢„Éó„É™Ëµ∑ÂãïÊôÇ„Å´Êó•‰ªò„ÉÅ„Çß„ÉÉ„ÇØÁî®„ÅÆ„Ç§„É≥„Çø„Éº„Éê„É´„ÇíË®≠ÂÆö
			function setupDateChangeChecker() {
			    // „Åô„Åß„Å´Ë®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØ„ÇØ„É™„Ç¢
			    if (dateCheckIntervalId !== null) {
			        clearInterval(dateCheckIntervalId);
			    }
  			    // 1ÂàÜ„Åî„Å®„Å´Êó•‰ªòÂ§âÊõ¥„Çí„ÉÅ„Çß„ÉÉ„ÇØ
			    setInterval(checkDateChange, 60000);
			}
            // „Çø„Ç§„Éû„ÉºÈñãÂßãÈñ¢Êï∞
            function startTimer() {
                if (!timer.isRunning) {
                    timer.isRunning = true;
                    timer.interval = setInterval(updateTimer, 1000);
                    startBtn.disabled = true;
                    pauseBtn.disabled = false;
                    if (timer.mode === 'work') {
                        statusDisplay.textContent = 'üî•‰ΩúÊ•≠‰∏≠';
                    }else{
                        statusDisplay.textContent = '‚òï‰ºëÊÜ©‰∏≠';
                    }
                }
            }

            // „Çø„Ç§„Éû„Éº‰∏ÄÊôÇÂÅúÊ≠¢Èñ¢Êï∞
            function pauseTimer() {
                if (timer.isRunning) {
                    timer.isRunning = false;
                    clearInterval(timer.interval);
                    startBtn.disabled = false;
                    pauseBtn.disabled = true;
                    if (timer.mode === 'work') {
                        statusDisplay.textContent = 'ÂÅúÊ≠¢‰∏≠(‰ΩúÊ•≠)';
                    }else{
                        statusDisplay.textContent = 'ÂÅúÊ≠¢‰∏≠(‰ºëÊÜ©)';
                    }
                }
            }

            // „Çø„Ç§„Éû„Éº„É™„Çª„ÉÉ„ÉàÈñ¢Êï∞
            function resetTimer() {
                pauseTimer();
                timer.mode = 'work';
                timer.currentTime = timer.workTime;
                timeDisplay.textContent = formatTime(timer.currentTime);
                statusDisplay.textContent = '‰ΩúÊ•≠';
                statusDisplay.style.color = 'var(--primary-color)';
                circleProgress.style.stroke = 'var(--primary-color)';
                
                // „Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº„É™„Çª„ÉÉ„Éà
                const circumference = 2 * Math.PI * parseFloat(circleProgress.getAttribute('r'));
                circleProgress.style.strokeDasharray = `${circumference} ${circumference}`;
                circleProgress.style.strokeDashoffset = 0;
            }

            // „Çø„Çπ„ÇØÊèèÁîªÈñ¢Êï∞
            function renderTasks() {
                taskList.innerHTML = '';
                
                let tasksToRender = tasks;
                if (hideCompleted) {
                    tasksToRender = tasks.filter(task => !task.completed);
                }
                
                tasksToRender.forEach(task => {
                    const taskItem = document.createElement('li');
                    taskItem.className = 'task-item';
                    taskItem.dataset.id = task.id;
                    
                    if (task.completed) {
                        taskItem.classList.add('task-completed');
                    }
                    
                    taskItem.innerHTML = `
                        <div class="task-drag-handle">‚ò∞</div>
                        <input type="checkbox" class="task-checkbox" ${task.completed ? 'checked' : ''}>
                        <span class="task-text">${task.text}</span>
                        <div class="task-pomodoro-counter">
                            ${task.completedPomodoros || 0}/${task.plannedPomodoros} üçÖ
                        </div>
                        <button class="task-delete">√ó</button>
                    `;
                    
                    // „Éâ„É©„ÉÉ„Ç∞„Ç§„Éô„É≥„ÉàË®≠ÂÆö
                    taskItem.setAttribute('draggable', 'true');
                    taskItem.addEventListener('dragstart', handleDragStart);
                    taskItem.addEventListener('dragover', handleDragOver);
                    taskItem.addEventListener('drop', handleDrop);
                    taskItem.addEventListener('dragend', handleDragEnd);
                    
                    // „ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„Ç§„Éô„É≥„Éà
                    const checkbox = taskItem.querySelector('.task-checkbox');
                    checkbox.addEventListener('change', () => {
                        const taskId = taskItem.dataset.id;
                        const taskIndex = tasks.findIndex(t => t.id === taskId);
                        
                        if (taskIndex !== -1) {
                            tasks[taskIndex].completed = checkbox.checked;
                            
                            if (checkbox.checked) {
                                taskItem.classList.add('task-completed');
                                stats.completedTasks++;
                            } else {
                                taskItem.classList.remove('task-completed');
                                stats.completedTasks--;
                            }
                            
                            updateStatisticsDisplay();
                            updateTasksCounter();
                            saveToLocalStorage();
                        }
                    });
                    
                    // ÂâäÈô§„Éú„Çø„É≥„Ç§„Éô„É≥„Éà
                    const deleteBtn = taskItem.querySelector('.task-delete');
                    deleteBtn.addEventListener('click', () => {
                        const taskId = taskItem.dataset.id;
                        const taskIndex = tasks.findIndex(t => t.id === taskId);
                        
                        if (taskIndex !== -1) {
                            if (tasks[taskIndex].completed) {
                                stats.completedTasks--;
                            }
                            
                            tasks.splice(taskIndex, 1);
                            taskItem.remove();
                            updateTasksCounter();
                            updateStatisticsDisplay();
                            saveToLocalStorage();
                        }
                    });
                    
                    // „Çø„Çπ„ÇØÈÅ∏Êäû„Ç§„Éô„É≥„Éà
                    taskItem.addEventListener('click', (e) => {
                        // „ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„Å®„Éú„Çø„É≥„ÇØ„É™„ÉÉ„ÇØ‰ª•Â§ñ„ÅÆÂ†¥Âêà„Å´„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Å´„Åô„Çã
                        if (!e.target.classList.contains('task-checkbox') &&
                            !e.target.classList.contains('task-delete') &&
                            !e.target.classList.contains('task-drag-handle')) {
                            
                            document.querySelectorAll('.task-item').forEach(item => {
                                item.classList.remove('active');
                            });
                            
                            taskItem.classList.add('active');
                        }
                    });
                    
                    taskList.appendChild(taskItem);
                });
                
                updateTasksCounter();
            }

            // „Çø„Çπ„ÇØ„Ç´„Ç¶„É≥„Çø„ÉºÊõ¥Êñ∞Èñ¢Êï∞
            function updateTasksCounter() {
                totalTasksDisplay.textContent = tasks.length;
                const completedCount = tasks.filter(task => task.completed).length;
                completedTasksDisplay.textContent = completedCount;
            }

			// 6. Áµ±Ë®àË°®Á§∫Êõ¥Êñ∞Èñ¢Êï∞„ÅÆ‰øÆÊ≠£
			function updateStatisticsDisplay() {
			    // ‰ªäÊó•„ÅÆ„Éá„Éº„Çø„ÇíÂèñÂæó
			    const today = formatDateYMD(new Date());
			    const todayEntry = stats.weeklyData.find(entry => entry.date === today) || { pomodoros: 0, focusTime: 0 };
			    
			    todayPomodorosDisplay.textContent = todayEntry.pomodoros;
			    totalTimeDisplay.textContent = todayEntry.focusTime;
			    completedTasksCountDisplay.textContent = stats.completedTasks;
			}

            // „Éâ„É©„ÉÉ„Ç∞ÔºÜ„Éâ„É≠„ÉÉ„ÉóÂÆüË£Ö
            let draggedItem = null;

            function handleDragStart(e) {
                draggedItem = this;
                setTimeout(() => {
                    this.classList.add('dragging');
                }, 0);
                
                // „Éá„Éº„ÇøËª¢ÈÄÅ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆË®≠ÂÆö
                e.dataTransfer.effectAllowed = 'move';
                e.dataTransfer.setData('text/plain', this.dataset.id);
            }

            function handleDragOver(e) {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
                
                const target = e.target.closest('.task-item');
                if (target && target !== draggedItem) {
                    const targetRect = target.getBoundingClientRect();
                    const targetCenter = targetRect.top + (targetRect.height / 2);
                    
                    if (e.clientY < targetCenter) {
                        target.parentNode.insertBefore(draggedItem, target);
                    } else {
                        target.parentNode.insertBefore(draggedItem, target.nextSibling);
                    }
                }
            }

            function handleDrop(e) {
                e.preventDefault();
                
                // „Çø„Çπ„ÇØÈÖçÂàó„ÅÆÈ†ÜÂ∫è„ÇÇÊõ¥Êñ∞
                const newTasks = [];
                document.querySelectorAll('.task-item').forEach(item => {
                    const taskId = item.dataset.id;
                    const task = tasks.find(t => t.id === taskId);
                    if (task) {
                        newTasks.push(task);
                    }
                });
                
                tasks = newTasks;
                saveToLocalStorage();
            }

            function handleDragEnd() {
                this.classList.remove('dragging');
                draggedItem = null;
            }

			// 7. ÈÄ±Èñì„ÉÅ„É£„Éº„ÉàÊèèÁîªÈñ¢Êï∞„ÅÆ‰øÆÊ≠£ - Ë®òÈå≤„Å´ÊÆã„Å£„Å¶„ÅÑ„Çã7ÂõûÂàÜ„ÇíË°®Á§∫
			function drawWeeklyChart() {
			    const svg = weeklyChart;
			    svg.innerHTML = '';
			    
			    const width = svg.clientWidth;
			    const height = svg.clientHeight;
			    const padding = 40;
			    const chartWidth = width - (padding * 2);
			    const chartHeight = height - (padding * 2);

			    // Ë®òÈå≤„Åï„Çå„Å¶„ÅÑ„Çã„Éá„Éº„Çø„ÇíÊó•‰ªòÈ†Ü„Å´„ÇΩ„Éº„Éà
			    let chartData = [...stats.weeklyData].sort((a, b) => {
			        return new Date(b.date) - new Date(a.date);
			    });

			    // „Éá„Éº„Çø„Åå„Å™„ÅÑÂ†¥Âêà„ÅØÊó©Êúü„É™„Çø„Éº„É≥
			    if (chartData.length === 0) {
			        // „Ç∞„É©„Éï„Åå„Å™„ÅÑ„Åì„Å®„ÇíÁ§∫„Åô„É°„ÉÉ„Çª„Éº„Ç∏„ÇíË°®Á§∫
			        const noDataText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
			        noDataText.setAttribute('x', width / 2);
			        noDataText.setAttribute('y', height / 2);
			        noDataText.setAttribute('text-anchor', 'middle');
			        noDataText.setAttribute('fill', 'var(--text-color)');
			        noDataText.setAttribute('font-size', '14');
			        noDataText.textContent = '„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì';
			        svg.appendChild(noDataText);
			        return;
			    }

			    // ÊúÄÂ§ß7„Å§„Åæ„Åß„ÅÆ„Éá„Éº„Çø„Çí‰ΩøÁî®
			    chartData = chartData.slice(0, 7);

			    // ÂêÑ„Ç®„É≥„Éà„É™„Å´Êó•‰ªò„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Å®Ë°®Á§∫Áî®„É©„Éô„É´„ÇíËøΩÂä†
			    chartData.forEach(entry => {
			        entry.dateObj = new Date(entry.date);
			        entry.label = formatDateLabel(entry.dateObj);
			    });

				// ÊúÄÂ§ßÂÄ§„ÇíË®àÁÆó (ÁèæÂú®„ÅÆË°®Á§∫„É¢„Éº„Éâ„Å´Âü∫„Å•„Åè)
				let maxValue;
				if (chartDisplayMode === 'pomodoros') {
				  maxValue = Math.max(...chartData.map(item => item.pomodoros), 1);
				} else {
				  maxValue = Math.max(...chartData.map(item => item.focusTime), 1);
				}
			    // „Éê„Éº„ÅÆÂπÖ„ÇíË®àÁÆó
			    const barWidth = chartWidth / chartData.length;

			    // YËª∏
			    const yAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
			    yAxis.setAttribute('x1', padding);
			    yAxis.setAttribute('y1', padding);
			    yAxis.setAttribute('x2', padding);
			    yAxis.setAttribute('y2', height - padding);
			    yAxis.setAttribute('stroke', 'var(--text-color)');
			    yAxis.setAttribute('stroke-width', '1');
			    svg.appendChild(yAxis);
			    
			    // XËª∏
			    const xAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
			    xAxis.setAttribute('x1', padding);
			    xAxis.setAttribute('y1', height - padding);
			    xAxis.setAttribute('x2', width - padding);
			    xAxis.setAttribute('y2', height - padding);
			    xAxis.setAttribute('stroke', 'var(--text-color)');
			    xAxis.setAttribute('stroke-width', '1');
			    svg.appendChild(xAxis);

			    // „Ç∞„É©„Éï„ÅÆ„Çø„Ç§„Éà„É´
			    const titleText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
			    titleText.setAttribute('x', width / 2);
			    titleText.setAttribute('y', padding / 2);
			    titleText.setAttribute('text-anchor', 'middle');
			    titleText.setAttribute('fill', 'var(--primary-color)');
			    titleText.setAttribute('font-size', '14');
			    titleText.setAttribute('font-weight', 'bold');
				titleText.textContent = chartDisplayMode === 'pomodoros' ? 
				                         '„Éù„É¢„Éâ„Éº„É≠Ë®òÈå≤Â±•Ê≠¥' : 'ÈõÜ‰∏≠ÊôÇÈñìË®òÈå≤Â±•Ê≠¥ (ÂàÜ)';
				svg.appendChild(titleText);
				  
			    // „Éê„Éº„Å®„É©„Éô„É´„ÇíÊèèÁîª
			    chartData.forEach((item, index) => {
					// Ë°®Á§∫„É¢„Éº„Éâ„Å´Âü∫„Å•„ÅÑ„Å¶ÂÄ§„ÇíÂèñÂæó
					const value = chartDisplayMode === 'pomodoros' ? item.pomodoros : item.focusTime;
					const barHeight = value / maxValue * chartHeight;
					const x = padding + (index * barWidth);
			        const y = height - padding - barHeight;
			        
					// „Éê„Éº„ÅÆËâ≤„ÇÇË°®Á§∫„É¢„Éº„Éâ„Å´„Çà„Å£„Å¶Â§âÊõ¥
					const barColor = chartDisplayMode === 'pomodoros' ? 
					                'var(--primary-color)' : 'var(--secondary-color)';
                     // „Éê„Éº
			        const bar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
			        bar.setAttribute('x', x + 5);
			        bar.setAttribute('y', y);
			        bar.setAttribute('width', barWidth - 10);
			        bar.setAttribute('height', barHeight);
			        bar.setAttribute('fill', barColor);
			        bar.setAttribute('rx', '4');
			        svg.appendChild(bar);
			        
			        // ÂÄ§„É©„Éô„É´
				    if (value > 0) {
				      const valueText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
			            valueText.setAttribute('x', x + barWidth / 2);
			            valueText.setAttribute('y', y - 5);
			            valueText.setAttribute('text-anchor', 'middle');
			            valueText.setAttribute('fill', 'var(--text-color)');
			            valueText.setAttribute('font-size', '12');
			            valueText.textContent = value;
			            svg.appendChild(valueText);
			        }

			        // Êó•‰ªò„Å®ÊõúÊó•„Çí2Ë°å„ÅßË°®Á§∫
			        const dateLabel = item.label.split('\n');

			        // Êó•‰ªò„É©„Éô„É´ (MM/DD)
			        const dateText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
			        dateText.setAttribute('x', x + barWidth / 2);
			        dateText.setAttribute('y', height - padding + 15);
			        dateText.setAttribute('text-anchor', 'middle');
			        dateText.setAttribute('fill', 'var(--text-color)');
			        dateText.setAttribute('font-size', '12');
			        dateText.textContent = dateLabel[0]; // MM/DDÈÉ®ÂàÜ
			        svg.appendChild(dateText);

			        // ÊõúÊó•„É©„Éô„É´
			        const weekdayText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
			        weekdayText.setAttribute('x', x + barWidth / 2);
			        weekdayText.setAttribute('y', height - padding + 30);
			        weekdayText.setAttribute('text-anchor', 'middle');
			        weekdayText.setAttribute('fill', 'var(--text-color)');
			        weekdayText.setAttribute('font-size', '10');
			        weekdayText.textContent = dateLabel[1]; // (ÊõúÊó•)ÈÉ®ÂàÜ
			        svg.appendChild(weekdayText);
			    });
			}
            // Êó•‰ªò„Çí„ÄåMM/DD„ÄçÂΩ¢Âºè„Å®ÊõúÊó•„Åß„Éï„Ç©„Éº„Éû„ÉÉ„Éà„Åô„ÇãÈñ¢Êï∞
            function formatDateLabel(date) {
                const month = date.getMonth() + 1; // Êúà„ÅØ0„Åã„ÇâÂßã„Åæ„Çã„ÅÆ„Åß+1
                const day = date.getDate();
                const weekdays = ['Êó•', 'Êúà', 'ÁÅ´', 'Ê∞¥', 'Êú®', 'Èáë', 'Âúü'];
                const weekday = weekdays[date.getDay()];
                return `${month}/${day}\n(${weekday})`;
            }
            // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆö
            function setupEventListeners() {
                // „Çø„Ç§„Éû„Éº„Ç≥„É≥„Éà„É≠„Éº„É´
                startBtn.addEventListener('click', startTimer);
                pauseBtn.addEventListener('click', pauseTimer);
                resetBtn.addEventListener('click', resetTimer);
                
                // ‰ΩúÊ•≠ÊôÇÈñì„Çπ„É©„Ç§„ÉÄ„Éº
                workTimeSlider.addEventListener('input', function() {
                    const value = parseInt(this.value);
                    workTimeDisplay.textContent = value;
                    timer.workTime = value * 60;
                    
                    if (timer.mode === 'work' && !timer.isRunning) {
                        timer.currentTime = timer.workTime;
                        timeDisplay.textContent = formatTime(timer.currentTime);
                    }
                    
                    saveToLocalStorage();
                });
                
                // ‰ºëÊÜ©ÊôÇÈñì„Çπ„É©„Ç§„ÉÄ„Éº
                breakTimeSlider.addEventListener('input', function() {
                    const value = parseInt(this.value);
                    breakTimeDisplay.textContent = value;
                    timer.breakTime = value * 60;
                    
                    if (timer.mode === 'break' && !timer.isRunning) {
                        timer.currentTime = timer.breakTime;
                        timeDisplay.textContent = formatTime(timer.currentTime);
                    }
                    
                    saveToLocalStorage();
                });
                
                // „ÉÜ„Éº„ÉûÂàá„ÇäÊõø„Åà
                themeToggle.addEventListener('change', function() {
                    if (this.checked) {
                        document.documentElement.setAttribute('data-theme', 'dark');
                    } else {
                        document.documentElement.removeAttribute('data-theme');
                    }
                    
                    saveToLocalStorage();
                });
                
                // „Éó„É™„Çª„ÉÉ„Éà„Éú„Çø„É≥
                presetButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const workTime = parseInt(this.dataset.work);
                        const breakTime = parseInt(this.dataset.break);
                        
                        workTimeSlider.value = workTime;
                        breakTimeSlider.value = breakTime;
                        workTimeDisplay.textContent = workTime;
                        breakTimeDisplay.textContent = breakTime;
                        
                        timer.workTime = workTime * 60;
                        timer.breakTime = breakTime * 60;
                        
                        if (timer.mode === 'work' && !timer.isRunning) {
                            timer.currentTime = timer.workTime;
                            timeDisplay.textContent = formatTime(timer.currentTime);
                        } else if (timer.mode === 'break' && !timer.isRunning) {
                            timer.currentTime = timer.breakTime;
                            timeDisplay.textContent = formatTime(timer.currentTime);
                        }
                        
                        saveToLocalStorage();
                    });
                });
                
                // „Çø„Çπ„ÇØËøΩÂä†„Éï„Ç©„Éº„É†
                taskForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const taskText = taskInput.value.trim();
                    const plannedPomodoros = parseInt(pomodoroCountInput.value) || 1;
                    
                    if (taskText) {
                        const newTask = {
                            id: Date.now().toString(),
                            text: taskText,
                            completed: false,
                            plannedPomodoros: plannedPomodoros,
                            completedPomodoros: 0,
                            createdAt: Date.now()
                        };
                        
                        tasks.push(newTask);
                        renderTasks();
                        saveToLocalStorage();
                        
                        taskInput.value = '';
                        pomodoroCountInput.value = '1';
                    }
                });
                
                // ÂÆå‰∫Ü„Çø„Çπ„ÇØË°®Á§∫Âàá„ÇäÊõø„Åà
                toggleCompletedBtn.addEventListener('click', function() {
                    hideCompleted = !hideCompleted;
                    renderTasks();
                });
                
                // ÈõÜ‰∏≠„É¢„Éº„ÉâÂàá„ÇäÊõø„Åà
                focusModeToggle.addEventListener('change', function() {
                    if (this.checked) {
                        document.body.classList.add('focus-mode');
                    } else {
                        document.body.classList.remove('focus-mode');
                    }
                });
                
                // „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫ÊôÇ„Å´„Ç∞„É©„ÉïÂÜçÊèèÁîª
                window.addEventListener('resize', drawWeeklyChart);

				// „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÅÆËøΩÂä†
				showPomodorosBtn.addEventListener('click', function() {
				  chartDisplayMode = 'pomodoros';
				  showPomodorosBtn.classList.add('active');
				  showFocusTimeBtn.classList.remove('active');
				  drawWeeklyChart();
				});

				showFocusTimeBtn.addEventListener('click', function() {
				  chartDisplayMode = 'focusTime';
				  showFocusTimeBtn.classList.add('active');
				  showPomodorosBtn.classList.remove('active');
				  drawWeeklyChart();
				});
            }

            // SVG„Éó„É≠„Ç∞„É¨„Çπ„Éê„ÉºÂàùÊúüÂåñ
            function initProgressCircle() {
                const circle = document.querySelector('.circle-progress-bar');
                const radius = circle.getAttribute('r');
                const circumference = 2 * Math.PI * parseFloat(radius);
                
                circle.style.strokeDasharray = `${circumference} ${circumference}`;
                circle.style.strokeDashoffset = '0';
            }

            // „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂàùÊúüÂåñ
            function init() {
                loadFromLocalStorage();
                initProgressCircle();
                resetTimer();
                setupEventListeners();
                setupDateChangeChecker();//Êó•‰ªò„ÉÅ„Çß„ÉÉ„ÇØ„ÅÆ„Çø„Ç§„Éû„ÉºË®≠ÂÆö
                renderTasks();
                updateStatisticsDisplay();
                drawWeeklyChart();
                
            }
            // „Çø„Ç§„Éû„ÉºÁµÇ‰∫ÜÊôÇ„Å´Âëº„Å≥Âá∫„ÅôÈÄöÁü•Èñ¢Êï∞
            function notifyTimerEnd() {
                // Êó¢Â≠ò„ÅÆÈü≥Â£∞ÈÄöÁü•
                //notificationSound.play();
                
                // „Éá„Çπ„ÇØ„Éà„ÉÉ„ÉóÈÄöÁü•„ÇíË°®Á§∫
                showNotification();
                
                // ÁîªÈù¢„Çí„Éï„É©„ÉÉ„Ç∑„É•„Åï„Åõ„ÇãË¶ñË¶öÁöÑÈÄöÁü•
                flashScreen();
            }

            // „Éá„Çπ„ÇØ„Éà„ÉÉ„ÉóÈÄöÁü•Ê©üËÉΩ
            function showNotification() {
                // „É≠„Éº„Ç´„É´„Éï„Ç°„Ç§„É´„Åã„Å©„ÅÜ„Åã„Çí„ÉÅ„Çß„ÉÉ„ÇØ
                if (location.protocol === 'file:') {
                    console.log('„É≠„Éº„Ç´„É´Áí∞Â¢É„Åß„ÅØÈÄöÁü•„ÅØÁÑ°Âäπ„Åß„Åô');
                    return; // „É≠„Éº„Ç´„É´Áí∞Â¢É„Åß„ÅØÈÄöÁü•„Çí„Çπ„Ç≠„ÉÉ„Éó
                }
                // ÈÄöÁü•„ÅÆÊ®©Èôê„Çí„ÉÅ„Çß„ÉÉ„ÇØ
                if (Notification.permission === "granted") {
                    // ÈÄöÁü•„Çí‰ΩúÊàê„Åó„Å¶Ë°®Á§∫
                    const notification = new Notification("FlowState", {
                        body: timer.mode === 'work' ? 
                            "‰ΩúÊ•≠ÊôÇÈñì„ÅåÁµÇ‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ‰ºëÊÜ©„Åó„Åæ„Åó„Çá„ÅÜ" : 
                            "‰ºëÊÜ©ÊôÇÈñì„ÅåÁµÇ‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅÊ¨°„ÅÆ‰ΩúÊ•≠„ÇíÂßã„ÇÅ„Åæ„Åó„Çá„ÅÜ",
                        requireInteraction: true // „É¶„Éº„Ç∂„Éº„ÅåÊìç‰Ωú„Åô„Çã„Åæ„ÅßÈÄöÁü•„ÇíÊ∂à„Åï„Å™„ÅÑÔºàWindowsÈÄöÁü•„Å´ÂäπÊûúÁöÑÔºâ
                    });
                    
                    // ÈÄöÁü•„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Åü„Å®„Åç„ÅÆÂá¶ÁêÜ
                    notification.onclick = function() {
                        window.focus(); // „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Ç¶„Ç£„É≥„Éâ„Ç¶„Å´„Éï„Ç©„Éº„Ç´„Çπ
                        notification.close();
                    };
                } else if (Notification.permission !== "denied") {
                    // ÈÄöÁü•„ÅÆË®±ÂèØ„ÇíÊ±Ç„ÇÅ„Çã
                    Notification.requestPermission().then(permission => {
                        if (permission === "granted") {
                            showNotification();
                        }
                    });
                }
            }

            // ÁîªÈù¢„Éï„É©„ÉÉ„Ç∑„É•„Ç®„Éï„Çß„ÇØ„Éà
            function flashScreen() {
                // „Éï„É©„ÉÉ„Ç∑„É•Áî®„ÅÆ„Ç™„Éº„Éê„Éº„É¨„Ç§Ë¶ÅÁ¥†„Çí‰ΩúÊàê
                const overlay = document.createElement('div');
                overlay.id = 'flash-overlay';
                
                // „Çπ„Çø„Ç§„É´Ë®≠ÂÆö
                overlay.style.position = 'fixed';
                overlay.style.top = '0';
                overlay.style.left = '0';
                overlay.style.width = '100%';
                overlay.style.height = '100%';
                overlay.style.backgroundColor = timer.mode === 'work' ? 
                    'rgba(255, 99, 71, 0.6)' : // ‰ΩúÊ•≠‚Üí‰ºëÊÜ©ÊôÇ„ÅØËµ§Á≥ª
                    'rgba(76, 175, 80, 0.6)';  // ‰ºëÊÜ©‚Üí‰ΩúÊ•≠ÊôÇ„ÅØÁ∑ëÁ≥ª
                overlay.style.zIndex = '9999';
                overlay.style.pointerEvents = 'none'; // „ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà„Çí‰∏ã„ÅÆË¶ÅÁ¥†„Å´ÈÄö„Åô
                
                // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Áî®„ÅÆ„Çπ„Çø„Ç§„É´Ë¶ÅÁ¥†„Çí‰ΩúÊàê
                const styleElement = document.createElement('style');
                styleElement.textContent = `
                    @keyframes flash-animation {
                        0%, 100% { opacity: 0; }
                        25%, 75% { opacity: 1; }
                    }
                    #flash-overlay {
                        animation: flash-animation 1.2s ease-in-out 2;
                    }
                `;
                
                // Ë¶ÅÁ¥†„ÇíDOM„Å´ËøΩÂä†
                document.head.appendChild(styleElement);
                document.body.appendChild(overlay);
                
                // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÁµÇ‰∫ÜÂæå„Å´Ë¶ÅÁ¥†„ÇíÂâäÈô§„Åô„Çã
                overlay.addEventListener('animationend', () => {
                    document.body.removeChild(overlay);
                    document.head.removeChild(styleElement);
                });
            }
            // ÂàùÊúüÂåñÂÆüË°å
            init();
        });
    </script>
</body>
</html>